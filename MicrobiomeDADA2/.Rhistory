setwd("/Volumes/Bioinfo/BioInformatics/MicrobiomeDADA2")
library(phyloseq)
library(dplyr)
library(BiMiCo)
library(ggplot2)
library(MicEco)
load("RData/physeq.RData")
minTotRelAbun = .00005
x = taxa_sums(physeq)
keepTaxa = (x / sum(x)) > minTotRelAbun
physeqprune = prune_taxa(keepTaxa, physeq)
physeqprune
bodysite=ps_venn(
physeqprune,
"body.site",
fraction = .25,
weight = FALSE,
relative = TRUE,
plot = TRUE
)
bodysite
set.seed(777)
dist = phyloseq::distance(physeqprune, meathod="bray", weighted=TRUE)
set.seed(777)
dist = phyloseq::distance(physeqprune, meathod="bray", weighted=TRUE)
set.seed(777)
dist = phyloseq::distance(physeqprune, method="bray", weighted=TRUE)
ordination = ordinate(physeqprune, method="NMDS", distance=dist)
braysubject=plot_ordination(physeqprune, ordination, color="subject") +
theme_classic() +
theme(strip.background = element_blank()) + stat_ellipse(aes(group=subject))
braysubject
braysubject=plot_ordination(physeqprune, ordination, color="body.site") +
theme_classic() +
theme(strip.background = element_blank()) + stat_ellipse(aes(group=body.site))
braybodysite
braybodysite=plot_ordination(physeqprune, ordination, color="body.site") +
theme_classic() +
theme(strip.background = element_blank()) + stat_ellipse(aes(group=body.site))
braybodysite
brayantibioticusage=plot_ordination(physeqprune, ordination, color="reported.antibiotic.usage") +
theme_classic() +
theme(strip.background = element_blank()) + stat_ellipse(aes(group=reported.antibiotic.usage))
brayantibioticusage
install.packages("vegan")
install.packages("vegan")
library(vegan)
adonis2(dist ~ sample_data(physeqprune)$subject)
adonis2(dist ~ sample_data(physeqprune)$body.site)
ps.disper<-betadisper(dist, sample_data(physeqprune)$body.site)
permutest(ps.disper, pair=TRUE)
adonis2(dist ~ sample_data(physeqprune)$reported.antibiotic.usage)
